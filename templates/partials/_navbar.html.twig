<!-- Navigation responsive avec dark mode -->
<nav class="relative bg-white dark:bg-gray-800 shadow-lg transition-colors duration-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
            <!-- Logo -->
            <div class="flex-shrink-0">
                <a href="{{ path('post_index') }}" class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                    üåê MiniRSN
                </a>
            </div>
            
            <!-- Navigation Desktop -->
            <div class="hidden md:block">
                <div class="ml-10 flex items-baseline space-x-4">
                    {% if app.user %}
                        <a href="{{ path('post_index') }}" 
                           class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md font-medium transition-colors">
                            Feed
                        </a>
                        <a href="{{ path('app_comment_index') }}" 
                           class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md font-medium transition-colors">
                            Mes Commentaires
                        </a>
                    {% endif %}
                </div>
            </div>
            
            <!-- User Menu + Dark Mode Toggle -->
            <div class="flex items-center space-x-4">
                <!-- Dark Mode Toggle -->
                <button id="theme-toggle"
                        class="p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors duration-200"
                        title="Changer le th√®me">
                    <!-- Ic√¥ne Lune (pour activer le dark mode) -->
                    <svg id="theme-toggle-dark-icon" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                    </svg>
                    <!-- Ic√¥ne Soleil (pour activer le light mode) -->
                    <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path>
                    </svg>
                </button>

                {% if app.user %}
                    <!-- User Dropdown -->
                    <div class="relative ml-3">
                        <div class="flex items-center">
                            <!-- User Avatar -->
                            <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm mr-3">
                                {% if app.user.name %}
                                    {{ app.user.name|first|upper }}
                                {% else %}
                                    {{ app.user.email|first|upper }}
                                {% endif %}
                            </div>
                            <span class="hidden sm:block text-gray-700 dark:text-gray-300 mr-4">
                                Bonjour {% if app.user.name %}{{ app.user.name }}{% else %}{{ app.user.email|split('@')[0] }}{% endif %}
                            </span>
                            <a href="{{ path('app_logout') }}" 
                               class="hidden md:inline-block text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 px-3 py-2 font-medium transition-colors">
                                D√©connexion
                            </a>
                        </div>
                    </div>
                {% else %}
                    <!-- Login/Register buttons -->
                    <a href="{{ path('app_login') }}" 
                       class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 font-medium transition-colors">
                        Connexion
                    </a>
                    <a href="{{ path('app_register') }}" 
                       class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md font-medium transition-colors duration-200">
                        S'inscrire
                    </a>
                {% endif %}

                <!-- Mobile menu button -->
                <div class="md:hidden absolute right-4 top-3 z-50">
                    <button id="mobile-menu-button" type="button" 
                            class="bg-gray-800 inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white"
                            aria-controls="mobile-menu" aria-expanded="false">
                        <svg id="mobile-menu-open-icon" class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                        <svg id="mobile-menu-close-icon" class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</nav>
                <!-- Mobile menu (hidden on desktop) will be placed here to appear under the nav -->
                <div id="mobile-menu" class="hidden md:hidden bg-white dark:bg-gray-800 px-2 pt-2 pb-3 space-y-1 shadow-inner w-full">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        {% if app.user %}
                            <a href="{{ path('post_index') }}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md font-medium">Feed</a>
                            <a href="{{ path('app_comment_index') }}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md font-medium">Mes Commentaires</a>
                            <a href="{{ path('app_logout') }}" class="block text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 px-3 py-2 rounded-md font-medium">D√©connexion</a>
                        {% else %}
                            <a href="{{ path('app_login') }}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md font-medium">Connexion</a>
                            <a href="{{ path('app_register') }}" class="block bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-md font-medium">S'inscrire</a>
                        {% endif %}
                    </div>
                </div>

<script>
    // Dark mode toggle functionality
    const themeToggleBtn = document.getElementById('theme-toggle');
    const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
    const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

    // R√©cup√©rer le th√®me sauvegard√© ou utiliser 'light' par d√©faut
    const savedTheme = localStorage.getItem('theme') || 'light';
    
    // Appliquer le th√®me initial
    if (savedTheme === 'dark') {
        document.documentElement.classList.add('dark');
        themeToggleLightIcon.classList.remove('hidden');
        themeToggleDarkIcon.classList.add('hidden');
    } else {
        document.documentElement.classList.remove('dark');
        themeToggleDarkIcon.classList.remove('hidden');
        themeToggleLightIcon.classList.add('hidden');
    }

    // Event listener pour le toggle
    themeToggleBtn.addEventListener('click', function() {
        // Toggle des classes
        themeToggleDarkIcon.classList.toggle('hidden');
        themeToggleLightIcon.classList.toggle('hidden');

        // Si actuellement dark mode
        if (document.documentElement.classList.contains('dark')) {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('theme', 'light');
        } else {
            document.documentElement.classList.add('dark');
            localStorage.setItem('theme', 'dark');
        }
    });

    // Mobile menu toggle
    (function() {
        const mobileBtn = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const openIcon = document.getElementById('mobile-menu-open-icon');
        const closeIcon = document.getElementById('mobile-menu-close-icon');

        if (!mobileBtn || !mobileMenu) return;

        mobileBtn.addEventListener('click', function() {
            const isHidden = mobileMenu.classList.contains('hidden');
            if (isHidden) {
                mobileMenu.classList.remove('hidden');
                mobileBtn.setAttribute('aria-expanded', 'true');
                openIcon.classList.add('hidden');
                closeIcon.classList.remove('hidden');
            } else {
                mobileMenu.classList.add('hidden');
                mobileBtn.setAttribute('aria-expanded', 'false');
                openIcon.classList.remove('hidden');
                closeIcon.classList.add('hidden');
            }
        });
    })();
</script>